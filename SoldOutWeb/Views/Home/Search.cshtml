@model SoldOutWeb.Models.SearchSummary

@{
    ViewBag.Title = "Search";
}

@section jsFunctions{
    <script type="text/javascript">
        google.load('visualization', '1');   // Don't need to specify chart libraries!
        google.setOnLoadCallback(drawVisualization);

        function drawVisualization() {
            var wrapper = new google.visualization.ChartWrapper({
                chartType: 'LineChart',
                dataTable: google.visualization.arrayToDataTable([
                ['Date', 'Price'],

            @foreach (var ph in Model.PriceHistory)
            {
                <text>
                    @Html.Raw(string.Format("['{0:D2}/{1}', {2:F2}],", ph.PricePeriod.Month, ph.PricePeriod.Year, ph.AveragePrice))
                </text>
            }

                //['01/2015', 20.99]
                ]),
                options: { 'title': '@Model.Name @Model.Description' },
                containerId: 'vis_div'
            });
            wrapper.draw();
        }
    </script>
}

<div class="row">
    <div class="col-md-12">
        <h2>@Model.Name (@Model.Description)</h2>
        <div>Last Ran: @Model.LastRun</div>
        <div>Total Results: @Model.TotalResults</div>
    </div>
</div>

<div class="row">
    <div id="vis_div" class="col-md-6 col-md-offset-3" style="width: 600px; height: 400px;"></div>
</div>