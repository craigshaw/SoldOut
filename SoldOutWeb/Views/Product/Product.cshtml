@model SoldOutWeb.Models.SearchSummary

@{
    ViewBag.Title = "Product Summary";
}

@section scripts{
    <script src="~/Scripts/charting.js" type="text/javascript"></script>
    <script>
        $(function () {
            charting.load();
            charting.setOnLoadCallback(function () {
                // New product charts
                //charting.loadProductPricesCandlestickChart('newproductPriceChartContainer', '/Api/CandlestickData/', 'newProductPrice');
                //charting.loadProductPricesMACD('newproductPriceMACDChartContainer', '/Api/MACData/', 'newProductPriceMACD');
                //charting.loadProductPricesForMACDBarChart('newproductPriceMACDBarChartContainer', '/Api/MACData/', 'newProductPriceMACDBarChart');
                charting.loadDailyProductPriceLineChart('newproductDailyPriceChartContainer', '/Api/MACData/', 'newProductDailyPrice');
                //charting.loadProductPriceLineChart('newproductPriceMonthlySummaryContainer', '/Api/PriceHistory/', 'newProductPriceMonthlySummary');

                // Used product charts
                //charting.loadProductPricesCandlestickChart('usedproductPriceChartContainer', '/Api/CandlestickData/', 'usedProductPrice');
                //charting.loadProductPricesMACD('usedproductPriceMACDChartContainer', '/Api/MACData/', 'usedProductPriceMACD');
                //charting.loadProductPricesForMACDBarChart('usedproductPriceMACDBarChartContainer', '/Api/MACData/', 'usedProductPriceMACDBarChart');
                charting.loadDailyProductPriceLineChart('usedproductDailyPriceChartContainer', '/Api/MACData/', 'usedProductDailyPrice');
                //charting.loadProductPriceLineChart('usedproductPriceMonthlySummaryContainer', '/Api/PriceHistory/', 'usedProductPriceMonthlySummary');

                // Misc data charts for the product
                charting.loadProductScatterGraphChart('productScatterGraphChartContainer', '/Api/Scattergraph/');
            });

            $(document).on('shown.bs.tab', 'a[data-toggle="tab"]', function (e) {
                // Which tab is selected?
                var target = $(e.target).attr("href").substring(1);

                // Redraw the charts
                //charting.redrawChart(target + 'ProductPrice');
                //charting.redrawChart(target + 'ProductPriceMACD');
                //charting.redrawChart(target + 'ProductPriceMACDBarChart');
                charting.redrawChart(target + 'ProductDailyPrice');
                //charting.redrawChart(target + 'ProductPriceMonthlySummary');
            })
        })
    </script>
}

<div class="row">
    <div class="col-md-12">
        <h2>@Model.Name (<a href="@Model.Link">@Model.Description</a>)</h2>
        <div>Product price data correct as of: @Model.LastRun</div>
        <div>Total Prices tracked: @Model.TotalResults</div>
    </div>
</div>

<div class="row">&nbsp;</div>

<ul class="nav nav-tabs nav-justified">
    <li class="active"><a data-toggle="tab" href="#new">New Prices</a></li>
    <li><a data-toggle="tab" href="#used">Used Prices</a></li>
</ul>

<div class="tab-content">
    <div id="new" class="tab-pane fade in active">
        <!-- New tab contents -->
        <div class="row">
            <div class="col-lg-12">
                <div id="newproductDailyPriceChartContainer" data-product-id="@Model.ProductID" data-product-condition-id="2" data-short-interval="12" data-long-interval="26" data-daysToLookBack="30">
                </div>
            </div>
        </div>
    </div>

    <!-- Used tab contents -->
    <div id="used" class="tab-pane fade">
        <div class="row">
            <div class="col-lg-12">
                <div id="usedproductDailyPriceChartContainer" data-product-id="@Model.ProductID" data-product-condition-id="0" data-short-interval="12" data-long-interval="26" data-daysToLookBack="30">
                </div>
            </div>
        </div>
    </div>
</div>


<h3>Other price data</h3>
<div class="row">
    <div class="col-lg-12">
        <div id="productScatterGraphChartContainer" class="chart-container" data-product-id="@Model.ProductID">
        </div>
    </div>
</div>
